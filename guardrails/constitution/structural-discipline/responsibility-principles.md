# 責務の原則

## 最高原則

**責務はMECE（相互排他的かつ網羅的）に分離する。** 各コンポーネントは単一の変更理由を持ち、責務の重複も漏れもない状態を維持する。

---

## 理念

### 単一責任の本質

コンポーネントが「1つのことをする」とは、**変更理由が1つである**ことを意味する。

- 機能の数ではなく、変更の軸で責務を判断する
- 「誰のために変更するか」が単一であること
- 変更理由が複数あれば、分離を検討する

### MECEの価値

**重複の問題**:
- メンテナンスコストの増大
- ルール変更時の整合性喪失リスク
- どこで何が実行されるかの不明瞭さ

**漏れの問題**:
- システムの脆弱性
- 予期しない動作
- 責務の所在不明

---

## 核心原則

### 原則1: 単一の真実の情報源

同じ知識は一箇所でのみ定義する。

- 定義の重複は整合性喪失のリスク
- 自動生成により、複数箇所で同じ定義を適用
- 参照による再利用を優先

### 原則2: レイヤー間の信頼

上位レイヤーの処理は下位レイヤーで重複しない。

- 各レイヤーは自身の責務のみを遂行
- 下位レイヤーは上位レイヤーの処理完了を前提とする
- 防御的な重複処理は禁止

### 原則3: 責務の明示

責務の境界を構造で表現する。

- ディレクトリ構造が責務の境界を示す
- 型システムで責務の範囲を制約
- 命名規則で責務を明示

### 原則4: 変更の局所化

変更が波及する範囲を最小化する。

- 責務が明確なら、変更は局所的
- 依存関係は責務の方向に従う
- 責務外への影響を遮断する境界を設ける

---

## 責務分離の適用

責務分離は、アーキテクチャの各所で適用される：

| 対象 | 責務の分離基準 |
|------|----------------|
| レイヤー | 技術的関心事（Handler/UseCase/Domain/Infrastructure） |
| モジュール | ビジネス機能（User/Project/Todo） |
| コンポーネント | 単一の変更理由（Entity/Repository/UseCase） |
| 検証 | 検証の種類（型/ドメイン/ビジネス/構造） |

**具体的な適用方法**: 各ポリシードキュメントを参照

---

## 責務分離の検証

以下の質問で責務の分離状態を確認する：

1. このコンポーネントの変更理由は1つか？
2. 同じ知識が複数箇所に定義されていないか？
3. 上位レイヤーの責務を下位で重複していないか？
4. 変更時に影響範囲は局所的か？

---

## boundaryとの関係

責務の分離は境界の設計と密接に関連する。責務が明確であれば境界も明確になり、境界が明確であれば責務も明確になる（`./boundary-principles.md`参照）。
