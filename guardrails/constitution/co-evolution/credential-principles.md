# クレデンシャル管理原則

## 最高原則

機微情報は**厳格に管理（Strictly Controlled）**されなければならない。

- **メモリ保持のみ許可**: クレデンシャルはメモリ上での保持・使用のみを許可し、永続化を禁止
- **出力の厳格な禁止**: 標準出力・ファイル・ログへの出力を絶対に禁止
- **簡易なオンボーディング**: 複雑な手順を要求せず、AIと人間が迅速にシステムを理解・利用できる状態を保つ

## 理念

### クレデンシャル管理の本質

クレデンシャル管理とは、**セキュリティの担保**と**開発体験の最適化**を両立させることである。

**セキュリティの担保**:

- 機微情報の漏洩を技術的に防止し、システムの安全性を保つ
- クレデンシャルの不適切な取り扱いを検知し、即座に是正する
- 最小権限の原則に基づき、必要な範囲でのみアクセスを許可する

**開発体験の最適化**:

- 複雑な手順を排除し、AIと人間が迅速にオンボーディングできる
- 環境変数・シークレット管理ツールを活用し、透過的にクレデンシャルを利用できる
- セキュリティ要件を満たしつつ、開発の生産性を維持する

### 得られるベネフィット

**セキュリティインシデントの防止**:

- クレデンシャルの漏洩リスクを最小化し、不正アクセスを防止
- 誤ってコミット・出力された機微情報を自動検知し、被害を未然に防ぐ
- コンプライアンス要件を満たし、監査に対応できる

**開発速度の維持**:

- 複雑なセキュリティ手順を自動化し、開発者の認知負荷を軽減
- AIが自律的にクレデンシャルを取得・利用し、人間の介入なしに開発を継続
- 新規メンバーのオンボーディング時間を短縮し、即座に開発に参加できる

**責任の明確化**:

- クレデンシャルのアクセス履歴を記録し、問題発生時に追跡可能
- 権限管理を一元化し、誰がどのリソースにアクセスできるかを明確化
- ローテーション・失効の手順を明文化し、緊急時に迅速に対応できる

## 制度：三権分立による実現

### Policy（立法）

クレデンシャル管理のルールを定義する。

#### 禁止事項

**出力の厳格な禁止**:

- 標準出力・ファイル・ログへの出力
- コードへのハードコーディング
- バージョン管理システムへのコミット
- エラーメッセージ・トレースへの含有

#### 許可事項

**メモリ保持のみ許可**:

- 環境変数またはシークレット管理ツールから取得し、メモリ上で保持
- 必要な処理でのみ利用し、処理完了後は参照を破棄

#### 管理原則

**環境分離**: 開発環境はローカル管理、本番環境はシークレット管理ツールで一元管理

**最小権限**: 必要なクレデンシャルのみにアクセスを許可し、権限を最小化

**監査可能性**: アクセス履歴を記録し、問題発生時に追跡可能にする

### Procedure（行政）

クレデンシャル管理を実装し、**セキュリティインシデントを防止**しつつ、**開発体験を最適化**する。

#### セキュアな取得・利用

**外部ソースからの取得**: 環境変数またはシークレット管理ツールから動的に取得し、メモリ上でのみ保持

**スコープの最小化**: クレデンシャルを必要とする処理のスコープを限定し、不要になった時点で参照を破棄

#### オンボーディングの簡素化

**統合認証**: 一つの認証で必要な全てのクレデンシャルにアクセスできる状態を実現し、複雑な手順を排除する

**透過的な利用**: クレデンシャル取得・管理を自動化し、開発者が個別に管理する必要をなくす

### Review（司法）

クレデンシャル管理の適切性を審査する。

#### 審査項目

**漏洩リスクの検出**:

- クレデンシャルが出力・永続化されていないか
- コードへのハードコーディングがないか
- 外部ソースから適切に取得されているか

**アクセス制御の確認**:

- 最小権限の原則が守られているか
- スコープが適切に制限されているか

#### 実施方法

**自動レビュー**: 静的解析でハードコーディングを検出、コミット前チェックで漏洩を防止

**手動レビュー**: PRレビュー時にクレデンシャルの取り扱いを確認、定期的な権限レビューで不要なアクセスを削除

## 原則の適用

### 機微情報の範囲

APIキー・トークン・パスワード・暗号化キー・証明書・個人情報を含む識別子を機微情報として厳格に管理する。

### 統合認証の実現

**一つの認証で全てにアクセス**: 開発者は組織アカウント等で一度認証すれば、必要な全てのクレデンシャルに自動的にアクセスできる状態を構築する。

**自動プロビジョニング**: 認証後、必要なクレデンシャルを動的に取得・メモリ展開し、個別設定の手順を排除する。

### インシデント対応

**即座の失効**: クレデンシャル漏洩時は即座に失効・ローテーションし、不正利用を防止する。

**影響範囲の特定**: アクセスログから影響範囲を特定し、関係者に通知する。

**再発防止**: レビュープロセスを改善し、同様のインシデントを防止する。
