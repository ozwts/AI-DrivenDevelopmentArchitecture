# Logger使用の責務（セマンティックレビュー）

> **Note:** ログ出力の内容・品質は静的解析では検証困難なため、セマンティックレビューで確認します。

## レビュー観点

### 1. 機密情報の出力禁止

ログに機密情報が含まれていないか？

**確認項目:**
- [ ] パスワード、トークン、APIキーが出力されていないか
- [ ] 個人情報（メールアドレス、電話番号等）が不必要に出力されていないか
- [ ] クレデンシャル情報が含まれていないか

**Good:**
```typescript
logger.info("ユーザー認証成功", { userId: user.id });
```

**Bad:**
```typescript
logger.info("ログイン", { password: input.password }); // ❌ パスワード
logger.info("認証", { token: authToken });             // ❌ トークン
```

---

### 2. 構造化ログの使用

文字列連結ではなく、構造化データを使用しているか？

**確認項目:**
- [ ] テンプレートリテラルによるログメッセージを避けているか
- [ ] 付加情報を第2引数のオブジェクトで渡しているか

**Good:**
```typescript
logger.info("ユーザー作成", { userId: user.id, email: user.email });
```

**Bad:**
```typescript
logger.info(`ユーザー ${user.id} が作成されました`); // ❌ 文字列連結
```

---

### 3. 日本語でログメッセージ

ログメッセージが日本語で記述されているか？

**確認項目:**
- [ ] メッセージ部分が日本語か
- [ ] AIと人間が迅速に理解できる内容か

**Good:**
```typescript
logger.info("プロジェクト作成完了", { projectId });
logger.warn("リソースが見つかりません", { todoId });
```

**Bad:**
```typescript
logger.info("Project created", { projectId }); // ❌ 英語
```

---

### 4. 適切なログレベルの使用

状況に応じた適切なログレベルを使用しているか？

**判断フローチャート:**
```
エラー発生時:
├─ システムの不具合か？ → YES → ERROR
└─ クライアント操作が原因か？ → YES → WARN

正常系:
├─ 監査・分析に必要か？ → YES → INFO
└─ 開発時のデバッグ用か？ → YES → DEBUG
```

**レベル別の使い分け:**

| レベル | 用途 | 例 |
|--------|------|-----|
| ERROR | 開発者対応が必要なシステム異常 | DB接続失敗、500エラー |
| WARN | クライアント操作起因の想定内エラー | バリデーション失敗、404 |
| INFO | 正常系の重要イベント | UseCase開始・完了 |
| DEBUG | 開発時のデバッグ情報 | リポジトリ操作詳細 |

---

### 5. レイヤー別責務の遵守

各レイヤーが適切なログ出力を行っているか？

| レイヤー | ログ出力 | 内容 |
|---------|---------|------|
| Handler | ○ | リクエスト受信、レスポンス送信 |
| UseCase | ○ | ビジネスロジックの実行開始・完了・失敗 |
| Repository | ○ | データ操作の詳細（DEBUG中心） |
| Domain | × | **ログ出力しない** |

> **Note:** ドメイン層のログ出力禁止は `no-domain-logging.ts` で静的解析されます。

---

### 6. 十分なログ出力

重要な処理にログが出力されているか？

**確認項目:**
- [ ] UseCase開始・完了時にINFOログを出力しているか
- [ ] エラー発生時に適切なレベルでログを出力しているか
- [ ] 外部サービス呼び出し時にDEBUGログを出力しているか

**重要な場面でのログ出力:**
```typescript
// UseCase開始・完了
logger.info("TODO作成開始", { title: input.title });
// ... 処理 ...
logger.info("TODO作成完了", { todoId: result.data.id });

// エラー発生時
if (!result.success) {
  logger.warn("リソースが見つかりません", { todoId });
  return result;
}
```

---

## 関連する静的解析ポリシー

| ファイル | 検証内容 |
|---------|---------|
| `no-console-log.ts` | console.logの直接使用禁止 |
| `no-domain-logging.ts` | ドメイン層でのログ出力禁止 |
