# 用語集（Glossary）ポリシー

## 核心原則

用語集は**命名の唯一の源泉**である。定義・シナリオ・コードで使用するすべての用語は、用語集に存在しなければならない。

## 責務

### 実施すること

1. **語彙の一元管理**: ビジネス全体で共有される用語を定義する
2. **英語名の標準化**: クラス名・ファイル名の源泉となる英語名を定義する
3. **定義の明確化**: 曖昧さを排除した定義を記述する

### 実施しないこと

1. **属性の詳細** → 定義ファイル（`30-definition.md`参照）で記述
2. **制約の詳細** → 定義ファイルで記述
3. **振る舞いの詳細** → シナリオファイル（`40-scenario.md`参照）で記述

## 配置

```
/contracts
  /business
    glossary.md
```

## 記述形式

```markdown
# 用語集

| 用語   | 英語名    | 定義   |
| ------ | --------- | ------ |
| {用語} | {English} | {定義} |
```

## 用語の順序

用語は**集約単位でグループ化**し、**親から子の順**で配置する。

### 順序ルール

1. **集約ごとにグループ化**: User、Todo、Project など集約単位でまとめる
2. **親を先に、子を後に**: 集約ルート → 関連エンティティ → 値オブジェクト
3. **依存される側を先に**: 他の用語から参照される用語を先に配置

## 定義・シナリオとの整合性

用語集は定義・シナリオの源泉であり、すべての用語は用語集に存在しなければならない。

### 網羅性の確認

定義・シナリオで使用される用語は、用語集に先行登録されている必要がある。

```markdown
// 定義ファイルで確認すべき箇所

# {概念名} ← 用語集に存在するか

## 属性

- {属性名} ← 参照する概念が用語集に存在するか

// シナリオファイルで確認すべき箇所

## 誰が

{アクター} ← 用語集に存在するか

## 何を

- {操作対象} ← 用語集に存在するか
```

### 英語名とコードの一致

用語集の英語名は、コードの命名と一致させる。

```typescript
// 用語集: Todo → Todo
// ✅ Good
todo.entity.ts, class Todo

// 用語集: Project Member → Project Member
// ✅ Good
project-member.entity.ts, class ProjectMember

// 用語集: Todo Status → Todo Status
// ✅ Good
todo-status.vo.ts, class TodoStatus
```

### 定義の品質

定義は一意で明確でなければならない。

```markdown
// ❌ Bad: 一意性違反（同じ概念に複数の名前）
| タスク | Task | やるべきこと |
| TODO | Todo | やるべきこと |

// ❌ Bad: 曖昧な定義
| 添付ファイル | Attachment | ファイルなど |

// ❌ Bad: 循環参照
| オーナー | Owner | プロジェクトオーナーの役割 |
| プロジェクトオーナー | Project Owner | オーナー権限を持つ人 |

// ✅ Good: 明確な定義
| 添付ファイル | Attachment | TODOに添付されるファイル。ファイル名、サイズ、種類を持つ |
```

## Do / Don't

### Do: 新しい概念を追加したら用語集を更新する

```markdown
// 1. まず用語集に追加
| プロジェクトメンバー | Project Member | プロジェクトに参加しているユーザー |

// 2. その後、定義ファイルで詳細を記述

# プロジェクトメンバー

## 定義

プロジェクトに参加しているユーザー。プロジェクト内のTODOを共同で管理できる。
```

### Do: 属性で参照する概念も用語集に含める

```markdown
// 用語集に「プロジェクトロール」を追加
| プロジェクトロール | Project Role | プロジェクトにおけるユーザーの役割。オーナーまたはメンバー |

// 定義で属性として使用

## 属性

- プロジェクトロール：オーナーまたはメンバー
```

### Don't: 用語集にない概念を定義・シナリオで使用する

```markdown
// ❌ Bad: 用語集に「参加者」がない状態で使用

## 属性

- 参加者：プロジェクトに参加しているユーザー

// ✅ Good: 用語集の「プロジェクトメンバー」を使用

## 属性

- プロジェクトメンバー：プロジェクトに参加しているユーザー
```

### Don't: 英語名をコードと異なる形で定義する

```markdown
// ❌ Bad: 英語名が不統一
| メンバー | Member | ... |
// コード: class ProjectMember（不一致）

// ✅ Good: 英語名が一致
| プロジェクトメンバー | Project Member | ... |
// コード: class ProjectMember（一致）
```

## 原則

| 原則                   | 説明                                        |
| ---------------------- | ------------------------------------------- |
| 一意性                 | 同じ概念に複数の名前を与えない              |
| 明確性                 | 曖昧な定義を避ける                          |
| ビジネス視点           | 技術的な実装詳細は書かない                  |
| 先行登録               | 定義・シナリオより先に用語集に登録する      |
| 順序の整頓             | 集約単位でグループ化し、親→子の順で配置する |
| コンテキスト修飾       | 曖昧な用語はコンテキストで修飾する          |
| 列挙値は独立定義しない | 列挙型の値は親の定義に含める                |

---

## コンテキスト修飾の原則

**将来の拡張で曖昧になる用語は、コンテキストで修飾する。**

### なぜ重要か

用語が属するコンテキスト（境界づけられたコンテキスト）を明示しないと、将来同じ用語が別の文脈で登場した際に混乱が生じる。

### 判断基準

| 質問                                           | 修飾が必要        |
| ---------------------------------------------- | ----------------- |
| この用語は他の文脈でも使われる可能性があるか？ | はい → 修飾する   |
| 用語だけで何を指すか一意に特定できるか？       | いいえ → 修飾する |

```markdown
// ❌ Bad: コンテキストなし（将来「チームオーナー」「組織オーナー」が出たら混乱）
| オーナー | Owner | プロジェクトの管理者 |
| メンバー | Member | プロジェクトの参加者 |

// ✅ Good: コンテキストで修飾
| プロジェクトオーナー | Project Owner | プロジェクトの管理者。編集・削除、メンバー管理が可能 |
| プロジェクトメンバー | Project Member | プロジェクトの参加者。TODO操作が可能 |
```

### 修飾が不要な例

```markdown
// ✅ Good: 「ユーザー」はシステム全体で一意（他の文脈で使わない）
| ユーザー | User | アプリケーションを利用する人 |

// ✅ Good: 「TODO」はこのドメイン固有の概念
| TODO | Todo | やるべきタスク |
```

---

## 列挙値の定義方針

**列挙型の値は独立した用語として定義しない。親の用語の定義に含める。**

### なぜ重要か

- 列挙値を独立定義すると、用語数が爆発する
- 親と値の関係が不明確になる
- 定義の重複が発生する

```markdown
// ❌ Bad: 列挙値を独立用語として定義（冗長）
| メンバー権限 | Member Role | プロジェクトメンバーの権限。オーナー、メンバーのいずれか |
| オーナー | Owner | プロジェクトの管理者 |
| メンバー | Member | プロジェクトの参加者 |

// ✅ Good: 列挙型のみを定義し、値は定義に含める
| プロジェクトメンバー権限 | Project Member Role | プロジェクトメンバーの権限。オーナー（管理者）、メンバー（参加者）のいずれか |

// ✅ Good: 既存の例（TODOステータス）
| TODOステータス | Todo Status | TODOの進捗状況。未着手、作業中、完了のいずれか |
// 「未着手」「作業中」「完了」を独立用語として定義していない
```

### 例外: 値が複雑な振る舞いを持つ場合

値自体が複雑な制約や振る舞いを持ち、定義ファイルで詳細を記述する必要がある場合は、独立用語として定義してもよい。

```markdown
// 例: 権限が複雑なルールを持つ場合（本システムでは該当しない）
| 管理者権限 | Admin Role | システム全体の管理権限。ユーザー管理、設定変更が可能 |
```
